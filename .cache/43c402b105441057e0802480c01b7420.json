{"dependencies":[{"name":"concordance","loc":{"line":2,"column":28}},{"name":"dot-prop","loc":{"line":3,"column":24}},{"name":"babel-generator","loc":{"line":4,"column":25}},{"name":"./concordance-options","loc":{"line":5,"column":35}},{"name":"empower-core","loc":{"line":36,"column":25}}],"generated":{"js":"'use strict';\nconst concordance = require('concordance');\nconst dotProp = require('dot-prop');\nconst generate = require('babel-generator').default;\nconst concordanceOptions = require('./concordance-options').default;\n\n// When adding patterns, don't forget to add to\n// https://github.com/avajs/babel-preset-transform-test-files/blob/master/espower-patterns.json\n// Then release a new version of that preset and bump the SemVer range here.\nconst PATTERNS = [\n\t't.truthy(value, [message])',\n\t't.falsy(value, [message])',\n\t't.true(value, [message])',\n\t't.false(value, [message])',\n\t't.regex(contents, regex, [message])',\n\t't.notRegex(contents, regex, [message])'\n];\n\nconst computeStatement = node => generate(node, {quotes: 'single'}).code;\nconst getNode = (ast, path) => dotProp.get(ast, path.replace(/\\//g, '.'));\n\nconst formatter = context => {\n\tconst ast = JSON.parse(context.source.ast);\n\tconst args = context.args[0].events;\n\treturn args\n\t\t.map(arg => {\n\t\t\tconst node = getNode(ast, arg.espath);\n\t\t\tconst statement = computeStatement(node);\n\t\t\tconst formatted = concordance.format(arg.value, concordanceOptions);\n\t\t\treturn [statement, formatted];\n\t\t})\n\t\t.reverse();\n};\n\nconst enhanceAssert = (pass, fail, assertions) => {\n\tconst empower = require('empower-core');\n\treturn empower(assertions, {\n\t\tdestructive: true,\n\t\tonError(event) {\n\t\t\tconst error = event.error;\n\t\t\tif (event.powerAssertContext) { // Context may be missing in internal tests.\n\t\t\t\terror.statements = formatter(event.powerAssertContext);\n\t\t\t}\n\t\t\tfail(this, error);\n\t\t},\n\t\tonSuccess() {\n\t\t\tpass(this);\n\t\t},\n\t\tpatterns: PATTERNS,\n\t\tbindReceiver: false\n\t});\n};\nmodule.exports = enhanceAssert;\n"},"hash":"fcbdf121c299d8cbd5bba55cc190b692"}